<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Sample the parameters for an additive model, which may contain
both linear and nonlinear predictors. The nonlinear terms are modeled
using orthogonalized splines. The sampler draws the linear terms
jointly and then samples each vector of nonlinear coefficients using
Bayesian backfitting (i.e., conditional on all other nonlinear and linear terms)."><title>Sample the parameters for an additive model — sample_bam_orthog • rSTAR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Sample the parameters for an additive model — sample_bam_orthog"><meta property="og:description" content="Sample the parameters for an additive model, which may contain
both linear and nonlinear predictors. The nonlinear terms are modeled
using orthogonalized splines. The sampler draws the linear terms
jointly and then samples each vector of nonlinear coefficients using
Bayesian backfitting (i.e., conditional on all other nonlinear and linear terms)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rSTAR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/rSTAR.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/bking124/rSTAR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Sample the parameters for an additive model</h1>
      <small class="dont-index">Source: <a href="https://github.com/bking124/rSTAR/blob/HEAD/R/internal_functions.R" class="external-link"><code>R/internal_functions.R</code></a></small>
      <div class="d-none name"><code>sample_bam_orthog.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Sample the parameters for an additive model, which may contain
both linear and nonlinear predictors. The nonlinear terms are modeled
using orthogonalized splines. The sampler draws the linear terms
jointly and then samples each vector of nonlinear coefficients using
Bayesian backfitting (i.e., conditional on all other nonlinear and linear terms).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sample_bam_orthog</span><span class="op">(</span></span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">X_lin</span>,</span>
<span>  <span class="va">X_nonlin</span>,</span>
<span>  <span class="va">params</span>,</span>
<span>  A <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="fl">4</span>,</span>
<span>  B_all <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  diagBtB_all <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  XtX <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>y</dt>
<dd><p><code>n x 1</code> vector of data</p></dd>


<dt>X_lin</dt>
<dd><p><code>n x pL</code> matrix of predictors to be modelled as linear</p></dd>


<dt>X_nonlin</dt>
<dd><p><code>n x pNL</code> matrix of predictors to be modelled as nonlinear</p></dd>


<dt>params</dt>
<dd><p>the named list of parameters containing</p><ol><li><p><code>mu</code>: vector of conditional means (fitted values)</p></li>
<li><p><code>sigma</code>: the conditional standard deviation</p></li>
<li><p><code>coefficients</code>: a named list of parameters that determine <code>mu</code></p></li>
</ol></dd>


<dt>A</dt>
<dd><p>the prior scale for <code>sigma_beta</code>, which we assume follows a Uniform(0, A) prior.</p></dd>


<dt>B_all</dt>
<dd><p>optional <code>pNL</code>-dimensional list of <code>n x L[j]</code> dimensional
basis matrices for each nonlinear term j=1,...,pNL; if NULL, compute internally</p></dd>


<dt>diagBtB_all</dt>
<dd><p>optional <code>pNL</code>-dimensional list of <code>diag(crossprod(B_all[[j]]))</code>;
if NULL, compute internally</p></dd>


<dt>XtX</dt>
<dd><p>optional <code>p x p</code> matrix of <code>crossprod(X)</code> (one-time cost);
if NULL, compute internally</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>The updated named list <code>params</code> with draws from the full conditional distributions
of <code>sigma</code> and <code>coefficients</code> (and updated <code>mu</code>).</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The parameters in <code>coefficients</code> are:</p><ul><li><p><code>beta</code>: the <code>p x 1</code> linear coefficients, including the linear terms from <code>X_nonlin</code></p></li>
<li><p><code>f_j</code>: the <code>n x pNL</code> matrix of fitted values for each nonlinear function</p></li>
<li><p><code>theta_j</code>: the <code>pNL</code>-dimensional of nonlinear basis coefficients</p></li>
<li><p><code>sigma_beta</code>: <code>p x 1</code> vector of linear regression coefficient standard deviations</p></li>
<li><p><code>sigma_theta_j</code>: <code>pNL x 1</code> vector of nonlinear coefficient standard deviations</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Simulate data for illustration:</span></span></span>
<span class="r-in"><span><span class="va">sim_dat</span> <span class="op">=</span> <span class="fu"><a href="simulate_nb_friedman.html">simulate_nb_friedman</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, p <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">=</span> <span class="va">sim_dat</span><span class="op">$</span><span class="va">y</span>; <span class="va">X</span> <span class="op">=</span> <span class="va">sim_dat</span><span class="op">$</span><span class="va">X</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Linear and nonlinear components:</span></span></span>
<span class="r-in"><span><span class="va">X_lin</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">X</span><span class="op">[</span>,<span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X_nonlin</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">X</span><span class="op">[</span>,<span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Initialize:</span></span></span>
<span class="r-in"><span><span class="va">params</span> <span class="op">=</span> <span class="fu">init_params_additive</span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, X_lin <span class="op">=</span> <span class="va">X_lin</span>, X_nonlin <span class="op">=</span> <span class="va">X_nonlin</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in init_params_additive(y = y, X_lin = X_lin, X_nonlin = X_nonlin):</span> could not find function "init_params_additive"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Sample:</span></span></span>
<span class="r-in"><span><span class="va">params</span> <span class="op">=</span> <span class="fu">sample_params_additive</span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>,</span></span>
<span class="r-in"><span>                                X_lin <span class="op">=</span> <span class="va">X_lin</span>,</span></span>
<span class="r-in"><span>                                X_nonlin <span class="op">=</span> <span class="va">X_nonlin</span>,</span></span>
<span class="r-in"><span>                                params <span class="op">=</span> <span class="va">params</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in sample_params_additive(y = y, X_lin = X_lin, X_nonlin = X_nonlin,     params = params):</span> could not find function "sample_params_additive"</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'params' not found</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">params</span><span class="op">$</span><span class="va">coefficients</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'params' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># And plot an example:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">X_nonlin</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">params</span><span class="op">$</span><span class="va">coefficients</span><span class="op">$</span><span class="va">f_j</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in xy.coords(x, y, xlabel, ylabel, log):</span> object 'params' not found</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="https://bking124.github.io/" class="external-link">Brian King</a>, <a href="http://www.danielrkowal.com/" class="external-link">Daniel R. Kowal</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

